2025-07-10 22:03:14,454 - session_manager - INFO - Loaded 2 sessions from file
2025-07-10 22:03:14,454 - session_manager - INFO - File-based session storage initialized: sessions.json
2025-07-10 22:03:14,457 - flask_server - WARNING - FLASK_SECRET_KEY not set. Using a default for development. Set a strong secret key in production!
2025-07-10 22:03:14,457 - flask_server - INFO - Starting Aida ERPNext AI Agent API server...
2025-07-10 22:03:14,471 - werkzeug - WARNING -  * Debugger is active!
2025-07-10 22:03:14,478 - werkzeug - INFO -  * Debugger PIN: 582-509-122
2025-07-10 22:03:20,589 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:03:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:03:23,561 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Admin\\Desktop\\aida_platform\\services\\aida_api_server.py', reloading
2025-07-10 22:03:23,585 - werkzeug - INFO -  * Detected change in 'C:\\Users\\Admin\\Desktop\\aida_platform\\services\\aida_api_server.py', reloading
2025-07-10 22:03:24,206 - werkzeug - INFO -  * Restarting with watchdog (windowsapi)
2025-07-10 22:03:28,582 - session_manager - INFO - Loaded 2 sessions from file
2025-07-10 22:03:28,582 - session_manager - INFO - File-based session storage initialized: sessions.json
2025-07-10 22:03:28,582 - flask_server - WARNING - FLASK_SECRET_KEY not set. Using a default for development. Set a strong secret key in production!
2025-07-10 22:03:28,582 - flask_server - INFO - Starting Aida ERPNext AI Agent API server...
2025-07-10 22:03:28,617 - werkzeug - WARNING -  * Debugger is active!
2025-07-10 22:03:28,623 - werkzeug - INFO -  * Debugger PIN: 582-509-122
2025-07-10 22:04:20,645 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:04:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:05:20,258 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:05:29,453 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:29] "OPTIONS /clear_session HTTP/1.1" 200 -
2025-07-10 22:05:29,717 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:29] "POST /clear_session HTTP/1.1" 200 -
2025-07-10 22:05:32,679 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:32] "OPTIONS /init_session HTTP/1.1" 200 -
2025-07-10 22:05:32,992 - flask_server - INFO - Init session request from: 127.0.0.1, Origin: http://127.0.0.1:5000
2025-07-10 22:05:32,992 - flask_server - INFO - Session request - URL: http://46.62.138.17:8000/, Username: Administrator, Restore: True
2025-07-10 22:05:33,724 - aida_agent - INFO - ‚úÖ Connected to ERPNext at http://46.62.138.17:8000/
2025-07-10 22:05:34,324 - aida_agent - WARNING - ERPNext API call failed (attempt 1/3) for operation 'call': ["Traceback (most recent call last):\n  File \"apps/frappe/frappe/handler.py\", line 73, in execute_cmd\n    method = get_attr(cmd)\n             ^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 254, in get_attr\n    method = globals()[cmd]\n             ~~~~~~~~~^^^^^\nKeyError: 'method'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"apps/frappe/frappe/app.py\", line 116, in application\n    response = frappe.api.handle(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/__init__.py\", line 49, in handle\n    data = endpoint(**arguments)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/v1.py\", line 36, in handle_rpc_call\n    return frappe.handler.handle()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 51, in handle\n    data = execute_cmd(cmd)\n           ^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 75, in execute_cmd\n    frappe.throw(_(\"Failed to get method for command {0} with {1}\").format(cmd, e))\n  File \"apps/frappe/frappe/utils/messages.py\", line 145, in throw\n    msgprint(\n  File \"apps/frappe/frappe/utils/messages.py\", line 106, in msgprint\n    _raise_exception()\n  File \"apps/frappe/frappe/utils/messages.py\", line 57, in _raise_exception\n    raise exc\nfrappe.exceptions.ValidationError: Failed to get method for command method with 'method'\n"]
2025-07-10 22:05:35,953 - aida_agent - WARNING - ERPNext API call failed (attempt 2/3) for operation 'call': ["Traceback (most recent call last):\n  File \"apps/frappe/frappe/handler.py\", line 73, in execute_cmd\n    method = get_attr(cmd)\n             ^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 254, in get_attr\n    method = globals()[cmd]\n             ~~~~~~~~~^^^^^\nKeyError: 'method'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"apps/frappe/frappe/app.py\", line 116, in application\n    response = frappe.api.handle(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/__init__.py\", line 49, in handle\n    data = endpoint(**arguments)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/v1.py\", line 36, in handle_rpc_call\n    return frappe.handler.handle()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 51, in handle\n    data = execute_cmd(cmd)\n           ^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 75, in execute_cmd\n    frappe.throw(_(\"Failed to get method for command {0} with {1}\").format(cmd, e))\n  File \"apps/frappe/frappe/utils/messages.py\", line 145, in throw\n    msgprint(\n  File \"apps/frappe/frappe/utils/messages.py\", line 106, in msgprint\n    _raise_exception()\n  File \"apps/frappe/frappe/utils/messages.py\", line 57, in _raise_exception\n    raise exc\nfrappe.exceptions.ValidationError: Failed to get method for command method with 'method'\n"]
2025-07-10 22:05:38,587 - aida_agent - WARNING - ERPNext API call failed (attempt 3/3) for operation 'call': ["Traceback (most recent call last):\n  File \"apps/frappe/frappe/handler.py\", line 73, in execute_cmd\n    method = get_attr(cmd)\n             ^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 254, in get_attr\n    method = globals()[cmd]\n             ~~~~~~~~~^^^^^\nKeyError: 'method'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"apps/frappe/frappe/app.py\", line 116, in application\n    response = frappe.api.handle(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/__init__.py\", line 49, in handle\n    data = endpoint(**arguments)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/v1.py\", line 36, in handle_rpc_call\n    return frappe.handler.handle()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 51, in handle\n    data = execute_cmd(cmd)\n           ^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 75, in execute_cmd\n    frappe.throw(_(\"Failed to get method for command {0} with {1}\").format(cmd, e))\n  File \"apps/frappe/frappe/utils/messages.py\", line 145, in throw\n    msgprint(\n  File \"apps/frappe/frappe/utils/messages.py\", line 106, in msgprint\n    _raise_exception()\n  File \"apps/frappe/frappe/utils/messages.py\", line 57, in _raise_exception\n    raise exc\nfrappe.exceptions.ValidationError: Failed to get method for command method with 'method'\n"]
2025-07-10 22:05:38,589 - aida_agent - ERROR - All ERPNext API retry attempts failed for call.
2025-07-10 22:05:39,181 - aida_agent - INFO - ‚úÖ ERPNext connection verified via User query.
2025-07-10 22:05:39,221 - aida_agent - INFO - ‚úÖ Google Gemini API configured.
2025-07-10 22:05:44,308 - aida_agent - WARNING - MongoDB connection failed: localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 68709ba37bf72e58a5bf4124, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [WinError 10061] No connection could be made because the target machine actively refused it (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>. Falling back to in-memory storage.
2025-07-10 22:05:44,308 - aida_agent - INFO - üìù Using in-memory conversation storage as MongoDB is not available or failed to connect.
2025-07-10 22:05:44,308 - aida_agent - INFO - ‚úÖ Memory management initialized. Mongo available: False
2025-07-10 22:05:44,308 - aida_agent - INFO - ‚ÑπÔ∏è Google Maps API key not provided  - CRM features disabled
2025-07-10 22:05:44,308 - aida_agent - INFO - üîç Discovering ERPNext system capabilities...
2025-07-10 22:05:44,308 - aida_agent - INFO - Attempting to discover apps via frappe.get_installed_apps API...
2025-07-10 22:05:44,911 - aida_agent - WARNING - ERPNext API call failed (attempt 1/3) for operation 'call': ["Traceback (most recent call last):\n  File \"apps/frappe/frappe/handler.py\", line 73, in execute_cmd\n    method = get_attr(cmd)\n             ^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 254, in get_attr\n    method = globals()[cmd]\n             ~~~~~~~~~^^^^^\nKeyError: 'method'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"apps/frappe/frappe/app.py\", line 116, in application\n    response = frappe.api.handle(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/__init__.py\", line 49, in handle\n    data = endpoint(**arguments)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/v1.py\", line 36, in handle_rpc_call\n    return frappe.handler.handle()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 51, in handle\n    data = execute_cmd(cmd)\n           ^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 75, in execute_cmd\n    frappe.throw(_(\"Failed to get method for command {0} with {1}\").format(cmd, e))\n  File \"apps/frappe/frappe/utils/messages.py\", line 145, in throw\n    msgprint(\n  File \"apps/frappe/frappe/utils/messages.py\", line 106, in msgprint\n    _raise_exception()\n  File \"apps/frappe/frappe/utils/messages.py\", line 57, in _raise_exception\n    raise exc\nfrappe.exceptions.ValidationError: Failed to get method for command method with 'method'\n"]
2025-07-10 22:05:46,520 - aida_agent - WARNING - ERPNext API call failed (attempt 2/3) for operation 'call': ["Traceback (most recent call last):\n  File \"apps/frappe/frappe/handler.py\", line 73, in execute_cmd\n    method = get_attr(cmd)\n             ^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 254, in get_attr\n    method = globals()[cmd]\n             ~~~~~~~~~^^^^^\nKeyError: 'method'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"apps/frappe/frappe/app.py\", line 116, in application\n    response = frappe.api.handle(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/__init__.py\", line 49, in handle\n    data = endpoint(**arguments)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/v1.py\", line 36, in handle_rpc_call\n    return frappe.handler.handle()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 51, in handle\n    data = execute_cmd(cmd)\n           ^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 75, in execute_cmd\n    frappe.throw(_(\"Failed to get method for command {0} with {1}\").format(cmd, e))\n  File \"apps/frappe/frappe/utils/messages.py\", line 145, in throw\n    msgprint(\n  File \"apps/frappe/frappe/utils/messages.py\", line 106, in msgprint\n    _raise_exception()\n  File \"apps/frappe/frappe/utils/messages.py\", line 57, in _raise_exception\n    raise exc\nfrappe.exceptions.ValidationError: Failed to get method for command method with 'method'\n"]
2025-07-10 22:05:49,130 - aida_agent - WARNING - ERPNext API call failed (attempt 3/3) for operation 'call': ["Traceback (most recent call last):\n  File \"apps/frappe/frappe/handler.py\", line 73, in execute_cmd\n    method = get_attr(cmd)\n             ^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 254, in get_attr\n    method = globals()[cmd]\n             ~~~~~~~~~^^^^^\nKeyError: 'method'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"apps/frappe/frappe/app.py\", line 116, in application\n    response = frappe.api.handle(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/__init__.py\", line 49, in handle\n    data = endpoint(**arguments)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/v1.py\", line 36, in handle_rpc_call\n    return frappe.handler.handle()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 51, in handle\n    data = execute_cmd(cmd)\n           ^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 75, in execute_cmd\n    frappe.throw(_(\"Failed to get method for command {0} with {1}\").format(cmd, e))\n  File \"apps/frappe/frappe/utils/messages.py\", line 145, in throw\n    msgprint(\n  File \"apps/frappe/frappe/utils/messages.py\", line 106, in msgprint\n    _raise_exception()\n  File \"apps/frappe/frappe/utils/messages.py\", line 57, in _raise_exception\n    raise exc\nfrappe.exceptions.ValidationError: Failed to get method for command method with 'method'\n"]
2025-07-10 22:05:49,131 - aida_agent - ERROR - All ERPNext API retry attempts failed for call.
2025-07-10 22:05:49,131 - aida_agent - WARNING - frappe.get_installed_apps API call failed: ["Traceback (most recent call last):\n  File \"apps/frappe/frappe/handler.py\", line 73, in execute_cmd\n    method = get_attr(cmd)\n             ^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 254, in get_attr\n    method = globals()[cmd]\n             ~~~~~~~~~^^^^^\nKeyError: 'method'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"apps/frappe/frappe/app.py\", line 116, in application\n    response = frappe.api.handle(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/__init__.py\", line 49, in handle\n    data = endpoint(**arguments)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/api/v1.py\", line 36, in handle_rpc_call\n    return frappe.handler.handle()\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 51, in handle\n    data = execute_cmd(cmd)\n           ^^^^^^^^^^^^^^^^\n  File \"apps/frappe/frappe/handler.py\", line 75, in execute_cmd\n    frappe.throw(_(\"Failed to get method for command {0} with {1}\").format(cmd, e))\n  File \"apps/frappe/frappe/utils/messages.py\", line 145, in throw\n    msgprint(\n  File \"apps/frappe/frappe/utils/messages.py\", line 106, in msgprint\n    _raise_exception()\n  File \"apps/frappe/frappe/utils/messages.py\", line 57, in _raise_exception\n    raise exc\nfrappe.exceptions.ValidationError: Failed to get method for command method with 'method'\n"]. Falling back to module analysis.
2025-07-10 22:05:49,131 - aida_agent - INFO - Discovering apps via doctype module analysis (fallback)...
2025-07-10 22:05:50,023 - aida_agent - INFO - üì± Discovered apps via module analysis: ['amazon', 'bulk_transaction', 'ecommerce_integrations', 'edi', 'erpnext', 'erpnext_integrations', 'frappe', 'helpdesk', 'maintenance', 'raven', 'setup', 'shopify', 'subcontracting', 'telephony', 'unicommerce', 'zenoti']
2025-07-10 22:05:50,023 - aida_agent - INFO - Discovering doctypes...
2025-07-10 22:05:51,254 - aida_agent - INFO - üìã Discovered 459 doctypes across 36 modules.
2025-07-10 22:05:51,254 - aida_agent - INFO -       - Accounts: 85 doctypes
2025-07-10 22:05:51,255 - aida_agent - INFO -       - Core: 60 doctypes
2025-07-10 22:05:51,255 - aida_agent - INFO -       - Stock: 43 doctypes
2025-07-10 22:05:51,255 - aida_agent - INFO -       - Desk: 30 doctypes
2025-07-10 22:05:51,255 - aida_agent - INFO -       - Setup: 29 doctypes
2025-07-10 22:05:51,255 - aida_agent - INFO -       - Website: 27 doctypes        
2025-07-10 22:05:51,255 - aida_agent - INFO -       - Integrations: 20 doctypes   
2025-07-10 22:05:51,255 - aida_agent - INFO -       - CRM: 15 doctypes
2025-07-10 22:05:51,255 - aida_agent - INFO - ü§ñ Aida AI Agent initialized successfully!
2025-07-10 22:05:51,255 - aida_agent - INFO - üì± Discovered 16 installed apps.    
2025-07-10 22:05:51,255 - aida_agent - INFO - üìã Found 459 available doctypes.    
2025-07-10 22:05:51,259 - aida_agent - INFO - ‚úÖ Agent executor created successfully.
2025-07-10 22:05:51,259 - flask_server - INFO - Restored session 11ccba6b-f74b-400a-a5a3-756bc88fa3fa for user: Administrator
2025-07-10 22:05:51,259 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:51] "POST /init_session HTTP/1.1" 200 -
2025-07-10 22:05:51,298 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:51] "GET /get_chat_history/11ccba6b-f74b-400a-a5a3-756bc88fa3fa HTTP/1.1" 200 -        
2025-07-10 22:06:20,572 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:06:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:07:20,269 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:07:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:08:20,571 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:08:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:09:20,267 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:09:20] "2025-07-10 22:05:51,259 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:51] "POST /init_session HTTP/1.1" 200 -
2025-07-10 22:05:51,298 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:05:51] "GET /get_chat_history/11ccba6b-f74b-400a-a5a3-756bc88fa3fa HTTP/1.1" 200 -        
2025-07-10 22:06:20,572 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:06:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:07:20,269 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:07:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:08:20,571 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:08:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:09:20,267 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:09:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:07:20,269 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:07:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:08:20,571 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:08:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:09:20,267 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:09:20] "2025-07-10 22:08:20,571 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:08:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:09:20,267 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:09:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:09:20,267 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:09:20] "2025-07-10 22:09:20,267 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:09:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:10:20,601 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:10:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:11:20,262 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:11:20] "GET /health HTTP/1.1" 200 -
2025-07-10 22:12:20,569 - werkzeug - INFO - 127.0.0.1 - - [10/Jul/2025 22:12:20] "GET /health HTTP/1.1" 200 -


